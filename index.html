<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>REDA | STARSHIP INTERSTELLAR</title>
    <style>
        body { margin: 0; background: #000; overflow: hidden; font-family: 'Courier New', monospace; }
        #ui { position: absolute; top: 20px; left: 20px; color: #00f2ff; text-shadow: 0 0 10px #00f2ff; z-index: 100; pointer-events: none; }
        #crosshair { position: absolute; top: 50%; left: 50%; width: 20px; height: 20px; border: 2px solid rgba(0,255,255,0.5); border-radius: 50%; transform: translate(-50%, -50%); z-index: 100; }
        #msg { position: absolute; width: 100%; text-align: center; top: 40%; color: #ff0055; font-size: 50px; display: none; z-index: 101; }
    </style>
</head>
<body>
    <div id="ui">
        <h2>MISSION: SURVIVE</h2>
        <p>DISTANCE: <span id="dist">0</span> LY</p>
    </div>
    <div id="crosshair"></div>
    <div id="msg">SYSTEM CRITICAL: DESTROYED</div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        let scene, camera, renderer, ship, asteroids = [], stars;
        let speed = 0.5, distance = 0, alive = true;

        function init() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            document.body.appendChild(renderer.domElement);

            // إضاءة احترافية
            const sun = new THREE.DirectionalLight(0xffffff, 1.5);
            sun.position.set(5, 5, 10);
            scene.add(sun);
            scene.add(new THREE.AmbientLight(0x222244));

            // إنشاء النجوم في الخلفية (نظام جزيئات)
            const starGeo = new THREE.BufferGeometry();
            const starCoords = [];
            for(let i=0; i<5000; i++) {
                starCoords.push(Math.random()*2000-1000, Math.random()*2000-1000, Math.random()*2000-1000);
            }
            starGeo.setAttribute('position', new THREE.Float32BufferAttribute(starCoords, 3));
            stars = new THREE.Points(starGeo, new THREE.PointsMaterial({color: 0xffffff, size: 0.7}));
            scene.add(stars);

            // السفينة (تصميم أكثر تعقيداً)
            const shipGroup = new THREE.Group();
            const body = new THREE.Mesh(new THREE.BoxGeometry(0.6, 0.2, 2), new THREE.MeshPhongMaterial({color: 0x555555}));
            const wing = new THREE.Mesh(new THREE.BoxGeometry(2, 0.05, 0.8), new THREE.MeshPhongMaterial({color: 0x333333}));
            shipGroup.add(body, wing);
            ship = shipGroup;
            scene.add(ship);
            camera.position.set(0, 1.5, 5);

            // إنشاء النيازك
            for(let i=0; i<40; i++) spawnAsteroid();

            animate();
        }

        function spawnAsteroid() {
            const geo = new THREE.IcosahedronGeometry(Math.random() * 0.8 + 0.2, 0);
            const mat = new THREE.MeshPhongMaterial({color: 0x888888, flatShading: true});
            const mesh = new THREE.Mesh(geo, mat);
            mesh.position.set(Math.random()*20-10, Math.random()*15-7.5, -Math.random()*100 - 50);
            scene.add(mesh);
            asteroids.push(mesh);
        }

        function animate() {
            if(!alive) return;
            requestAnimationFrame(animate);

            // حركة النجوم ليعطي شعور السرعة
            stars.rotation.z += 0.001;
            stars.position.z += speed * 2;
            if(stars.position.z > 500) stars.position.z = 0;

            // تحريك النيازك
            asteroids.forEach(a => {
                a.position.z += speed;
                a.rotation.x += 0.01;
                if(a.position.z > 10) {
                    a.position.z = -100;
                    a.position.x = Math.random()*20-10;
                    a.position.y = Math.random()*15-7.5;
                }

                // تصادم دقيق
                if(ship.position.distanceTo(a.position) < 1.2) endGame();
            });

            distance += 0.1;
            document.getElementById('dist').innerText = Math.floor(distance);
            speed += 0.0001;

            renderer.render(scene, camera);
        }

        function endGame() {
            alive = false;
            document.getElementById('msg').style.display = 'block';
            setTimeout(() => location.reload(), 3000);
        }

        window.addEventListener('mousemove', (e) => {
            if(!alive) return;
            const x = (e.clientX / window.innerWidth) * 2 - 1;
            const y = -(e.clientY / window.innerHeight) * 2 + 1;
            ship.position.x = x * 5;
            ship.position.y = y * 3;
            camera.position.x = ship.position.x * 0.5; // تأخر الكاميرا قليلاً يعطي انسيابية
        });

        init();
    </script>
</body>
</html>
