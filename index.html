<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>Hand-Drawn Masterpiece: The Ghost</title>
    <style>
        body { margin: 0; overflow: hidden; background: #08080a; cursor: none; }
        canvas { display: block; filter: contrast(1.1) saturate(1.2); }
    </style>
</head>
<body>

<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
let w = canvas.width = window.innerWidth;
let h = canvas.height = window.innerHeight;

let frame = 0;
const keys = {};

const ghost = {
    x: w/2, y: h-150, vx: 0, vy: 0,
    dir: 1, isJumping: false,
    points: Array.from({length: 12}, (_, i) => ({x: 0, y: i * 8})) // نقاط العباءة
};

// --- دالة رسم خط "مرسوم باليد" (Wobbly Line) ---
function drawHandLine(x1, y1, x2, y2, color, width) {
    ctx.beginPath();
    ctx.strokeStyle = color;
    ctx.lineWidth = width;
    ctx.lineCap = "round";
    
    let midX = (x1 + x2) / 2 + (Math.random() - 0.5) * 2;
    let midY = (y1 + y2) / 2 + (Math.random() - 0.5) * 2;
    
    ctx.moveTo(x1, y1);
    ctx.quadraticCurveTo(midX, midY, x2, y2);
    ctx.stroke();
}

function drawGhostMasterpiece() {
    ctx.save();
    ctx.translate(ghost.x, ghost.y);
    
    // أنيميشن "النبض" (Breathing) كأن الرسمة حية
    let pulse = Math.sin(frame * 0.1) * 2;
    let tilt = ghost.vx * 0.04;
    ctx.rotate(tilt);

    // 1. العباءة المنسوجة (The Ink Cloak)
    // العباءة مخدومة بنظام "Verlet Integration" مبسط للفيزياء
    ctx.fillStyle = "rgba(10, 10, 20, 0.9)";
    ctx.beginPath();
    ctx.moveTo(-35, 0);
    
    ghost.points.forEach((p, i) => {
        // حساب حركة كل نقطة ف العباءة بناء على سرعة اللاعب
        p.x += ((-35 - ghost.vx * 5) - p.x) * 0.1 * (i/12);
        let wave = Math.sin(frame * 0.15 + i * 0.5) * 10;
        ctx.lineTo(p.x + (i * 6), 90 + wave + (ghost.vy * 2));
    });
    
    ctx.lineTo(35, 0);
    ctx.fill();
    // إضافة خطوط خربشة (Hatching) للعباءة
    for(let i=0; i<5; i++) {
        drawHandLine(-20 + i*10, 20, -15 + i*10, 70, "rgba(255,255,255,0.05)", 1);
    }

    // 2. القناع "الخزفي" (The Porcelain Mask)
    // رسم القناع بطبقات من الظلال اليدوية
    ctx.fillStyle = "#f0f0f5";
    ctx.beginPath();
    // الرأس مرسوم بـ 4 منحنيات ليعطي شكل "غير مثالي" كأنه يدوي
    ctx.moveTo(0, -55 + pulse);
    ctx.bezierCurveTo(35, -55, 30, 15, 0, 15 + pulse);
    ctx.bezierCurveTo(-30, 15, -35, -55, 0, -55 + pulse);
    ctx.fill();
    
    // رسم حدود القناع بخط "خشن"
    ctx.strokeStyle = "rgba(0,0,0,0.2)";
    ctx.lineWidth = 2;
    ctx.stroke();

    // 3. العيون (Deep Ink Wells)
    ctx.fillStyle = "#050508";
    // العين اليمنى
    ctx.beginPath();
    ctx.ellipse(12, -18 + pulse, 7 + Math.random(), 14 + Math.random(), 0.1, 0, Math.PI*2);
    ctx.fill();
    // العين اليسرى
    ctx.beginPath();
    ctx.ellipse(-12, -18 + pulse, 7 + Math.random(), 14 + Math.random(), -0.1, 0, Math.PI*2);
    ctx.fill();

    // 4. القرون (Hand-Sculpted Horns)
    ctx.fillStyle = "#f0f0f5";
    // القرن الأيمن
    ctx.beginPath();
    ctx.moveTo(15, -45 + pulse);
    ctx.quadraticCurveTo(45 + pulse, -95, 10, -55 + pulse);
    ctx.fill();
    // القرن الأيسر
    ctx.beginPath();
    ctx.moveTo(-15, -45 + pulse);
    ctx.quadraticCurveTo(-45 - pulse, -95, -10, -55 + pulse);
    ctx.fill();

    ctx.restore();
}

function drawBackground() {
    // رسم أشجار "الفراغ" كأنها مرسومة بالفحم
    ctx.strokeStyle = "rgba(20, 20, 30, 0.5)";
    for(let i=0; i<5; i++) {
        let tx = (i * 400 - ghost.x * 0.3 + w) % (w + 400) - 200;
        ctx.lineWidth = 20;
        ctx.beginPath();
        ctx.moveTo(tx, h);
        ctx.lineTo(tx + 50, h - 400);
        ctx.stroke();
    }
}

function loop() {
    // مسح الشاشة مع ترك أثر خفيف (Motion Trail)
    ctx.fillStyle = "rgba(8, 8, 12, 0.2)";
    ctx.fillRect(0, 0, w, h);

    drawBackground();
    
    // إضاءة "سينمائية" حول الشخصية
    let shadow = ctx.createRadialGradient(ghost.x, ghost.y - 20, 0, ghost.x, ghost.y - 20, 250);
    shadow.addColorStop(0, "rgba(255, 255, 255, 0.08)");
    shadow.addColorStop(1, "transparent");
    ctx.fillStyle = shadow;
    ctx.fillRect(0,0,w,h);

    drawGhostMasterpiece();

    // فيزياء الحركة
    ghost.vy += 0.8;
    ghost.y += ghost.vy;
    ghost.x += ghost.vx;

    if(ghost.y > h - 150) {
        ghost.y = h - 150;
        ghost.vy = 0;
        ghost.isJumping = false;
    }

    if(keys.ArrowRight || keys.KeyD) { ghost.vx = 6; ghost.dir = 1; }
    else if(keys.ArrowLeft || keys.KeyA) { ghost.vx = -6; ghost.dir = -1; }
    else { ghost.vx *= 0.8; }

    frame++;
    requestAnimationFrame(loop);
}

window.onkeydown = e => {
    keys[e.code] = true;
    if(e.code === 'Space' && !ghost.isJumping) { ghost.vy = -18; ghost.isJumping = true; }
};
window.onkeyup = e => keys[e.code] = false;

loop();
</script>
</body>
</html>
