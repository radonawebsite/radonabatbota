<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>REDA WORLD - Phase 6 (BOSS FIGHT)</title>
    <style>
        body { margin: 0; overflow: hidden; background: #1a1a1a; font-family: sans-serif; }
        #ui { position: absolute; top: 10px; left: 10px; color: white; background: rgba(0,0,0,0.6); padding: 15px; border-radius: 8px; z-index: 10; border-left: 5px solid #ff0055; }
        #boss-health { position: absolute; top: 20px; left: 50%; transform: translateX(-50%); width: 300px; height: 20px; background: #333; border: 2px solid #fff; display: none; }
        #boss-fill { width: 100%; height: 100%; background: #ff0055; transition: 0.3s; }
        #msg { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #ff0055; font-size: 40px; font-weight: bold; display: none; text-shadow: 2px 2px #000; }
    </style>
</head>
<body>
    <div id="ui">
        <b>REDA WORLD - Phase 6</b><br>
        Ø§Ù„Ø¶Ø­Ø§ÙŠØ§: <span id="kills">0</span> / 5 Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ù„ÙˆØ­Ø´<br>
        Ø§Ù„Ù…Ø³ØªÙˆÙ‰: <span id="lvl">1</span>
    </div>
    <div id="boss-health"><div id="boss-fill"></div></div>
    <div id="msg">Ø¸Ù‡ÙˆØ± Ø§Ù„ÙˆØ­Ø´ Ø§Ù„Ø¹Ù…Ù„Ø§Ù‚! ðŸ‘¹</div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        window.onload = () => {
            const scene = new THREE.Scene();
            scene.background = new THREE.Color(0x87CEEB);
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            scene.add(new THREE.HemisphereLight(0xffffff, 0x444444, 1));

            const ground = new THREE.Mesh(new THREE.PlaneGeometry(200, 200), new THREE.MeshPhongMaterial({color: 0x348C31}));
            ground.rotation.x = -Math.PI / 2;
            scene.add(ground);

            const player = new THREE.Group();
            const pBody = new THREE.Mesh(new THREE.BoxGeometry(0.6, 1.5, 0.4), new THREE.MeshPhongMaterial({color: 0x0066ff}));
            pBody.position.y = 0.75;
            player.add(pBody);
            const sword = new THREE.Mesh(new THREE.BoxGeometry(0.1, 0.1, 1.2), new THREE.MeshPhongMaterial({color: 0xffcc00}));
            sword.position.set(0.4, 0.8, -0.6);
            player.add(sword);
            scene.add(player);

            let enemies = [];
            let killCount = 0;
            let boss = null;
            let bossHP = 100;
            let isBossActive = false;

            function spawnEnemy() {
                const enemy = new THREE.Mesh(new THREE.BoxGeometry(1, 1, 1), new THREE.MeshPhongMaterial({color: 0xff0000}));
                enemy.position.set(Math.random()*40-20, 0.5, Math.random()*40-20);
                scene.add(enemy);
                enemies.push(enemy);
            }
            for(let i=0; i<8; i++) spawnEnemy();

            window.onclick = () => {
                sword.rotation.x = -Math.PI / 3;
                setTimeout(() => sword.rotation.x = 0, 100);

                if(isBossActive && player.position.distanceTo(boss.position) < 5) {
                    bossHP -= 10;
                    document.getElementById('boss-fill').style.width = bossHP + "%";
                    if(bossHP <= 0) {
                        scene.remove(boss);
                        alert("Ù…Ø¨Ø±ÙˆÙƒ! Ù‚ØªÙ„Øª Ø§Ù„ÙˆØ­Ø´ Ø§Ù„Ø¹Ù…Ù„Ø§Ù‚ ÙŠØ§ Ø¨Ø·Ù„!");
                        location.reload();
                    }
                }

                enemies.forEach((enemy, index) => {
                    if(player.position.distanceTo(enemy.position) < 3) {
                        scene.remove(enemy);
                        enemies.splice(index, 1);
                        killCount++;
                        document.getElementById('kills').innerText = killCount;
                        if(killCount === 5) startBossBattle();
                        else spawnEnemy();
                    }
                });
            };

            function startBossBattle() {
                isBossActive = true;
                document.getElementById('msg').style.display = 'block';
                document.getElementById('boss-health').style.display = 'block';
                document.getElementById('lvl').innerText = "2 (BOSS)";
                scene.background = new THREE.Color(0x330000); // ØªØºÙŠÙŠØ± Ø§Ù„Ø¬Ùˆ Ù„Ù„Ø§Ø­Ù…Ø±
                
                // ØµÙ†Ø¹ Ø§Ù„ÙˆØ­Ø´
                boss = new THREE.Mesh(new THREE.BoxGeometry(4, 6, 4), new THREE.MeshPhongMaterial({color: 0x000000, emissive: 0xff0000}));
                boss.position.set(0, 3, -20);
                scene.add(boss);
                setTimeout(() => document.getElementById('msg').style.display = 'none', 3000);
            }

            const keys = {};
            window.onkeydown = (e) => keys[e.code] = true;
            window.onkeyup = (e) => keys[e.code] = false;

            function animate() {
                requestAnimationFrame(animate);
                if (keys['KeyW']) player.translateZ(-0.2);
                if (keys['KeyS']) player.translateZ(0.2);
                if (keys['KeyA']) player.rotation.y += 0.05;
                if (keys['KeyD']) player.rotation.y -= 0.05;

                if(isBossActive && boss) {
                    boss.position.x += Math.sin(Date.now() * 0.002) * 0.1; // Ø§Ù„ÙˆØ­Ø´ ÙƒÙŠØªØ­Ø±Ùƒ
                }

                const offset = new THREE.Vector3(0, 6, 12).applyMatrix4(player.matrixWorld);
                camera.position.lerp(offset, 0.1);
                camera.lookAt(player.position.x, player.position.y + 1, player.position.z);
                renderer.render(scene, camera);
            }
            animate();
        };
    </script>
</body>
</html>
