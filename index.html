<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>COSMIC ESCAPE - REDA</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: sans-serif; }
        #overlay { position: absolute; z-index: 10; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; background: rgba(0,0,0,0.8); color: #0ff; }
        .btn { padding: 15px 30px; font-size: 20px; background: #0ff; border: none; cursor: pointer; color: #000; font-weight: bold; }
        #ui { position: absolute; top: 10px; left: 10px; color: #0ff; font-size: 20px; z-index: 5; display: none; }
    </style>
</head>
<body>
    <div id="ui">SCORE: <span id="score">0</span></div>
    <div id="overlay">
        <h1>COSMIC ESCAPE</h1>
        <p>استخدم الأسهم للتحرك وتفادي الكويكبات</p>
        <button class="btn" onclick="startGame()">بدء الهروب</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        let scene, camera, renderer, player, obstacles = [], gameRunning = false, score = 0;

        function init() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            camera.position.z = 5;

            // إضاءة
            const light = new THREE.PointLight(0xffffff, 1, 100);
            light.position.set(0, 5, 5);
            scene.add(light);
            scene.add(new THREE.AmbientLight(0x333333));

            // اللاعب (مكعب أخضر)
            player = new THREE.Mesh(new THREE.BoxGeometry(0.5, 0.5, 0.5), new THREE.MeshPhongMaterial({ color: 0x00ff00 }));
            scene.add(player);

            // إنشاء عوائق
            for(let i=0; i<20; i++) {
                let obs = new THREE.Mesh(new THREE.SphereGeometry(0.3, 12, 12), new THREE.MeshPhongMaterial({ color: 0xff0000 }));
                resetObstacle(obs);
                scene.add(obs);
                obstacles.push(obs);
            }
        }

        function resetObstacle(obs) {
            obs.position.set(Math.random()*10-5, Math.random()*10-5, -Math.random()*20 - 10);
        }

        function startGame() {
            document.getElementById('overlay').style.display = 'none';
            document.getElementById('ui').style.display = 'block';
            if(!scene) init();
            gameRunning = true;
            animate();
        }

        function animate() {
            if(!gameRunning) return;
            requestAnimationFrame(animate);

            obstacles.forEach(obs => {
                obs.position.z += 0.1;
                if(obs.position.z > 5) resetObstacle(obs);

                // تصادم بسيط
                if(player.position.distanceTo(obs.position) < 0.6) {
                    alert("انتهت اللعبة! رصيدك: " + Math.floor(score));
                    location.reload();
                    gameRunning = false;
                }
            });

            score += 0.1;
            document.getElementById('score').innerText = Math.floor(score);
            renderer.render(scene, camera);
        }

        window.addEventListener('keydown', (e) => {
            if(e.key === "ArrowLeft") player.position.x -= 0.2;
            if(e.key === "ArrowRight") player.position.x += 0.2;
            if(e.key === "ArrowUp") player.position.y += 0.2;
            if(e.key === "ArrowDown") player.position.y -= 0.2;
        });
    </script>
</body>
</html>
