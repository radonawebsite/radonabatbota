<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>هروب الآلي Z-100</title>
    <style>
        /* ستايل باش ميبقاش الموقع كحل وميت */
        body { 
            margin: 0; 
            padding: 0; 
            overflow: hidden; 
            background: #1a1a2e; /* لون أزرق ليلي عميق */
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100-vh;
            font-family: Arial, sans-serif;
        }
        canvas { 
            border: 4px solid #0ff; 
            box-shadow: 0 0 20px #0ff;
            background: #000; /* مساحة اللعب */
        }
        #ui {
            position: absolute;
            top: 10%;
            color: #0ff;
            font-size: 24px;
            text-align: center;
            width: 100%;
            pointer-events: none;
        }
    </style>
</head>
<body>

    <div id="ui">
        <div id="score">الطاقة: 0%</div>
        <div id="msg">اضغط على <b>Space</b> أو <b>الشاشة</b> للقفز</div>
    </div>
    <canvas id="gameCanvas"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // تعديل حجم الكانفاس
        canvas.width = 800;
        canvas.height = 400;

        let score = 0;
        let gameActive = true;
        let frames = 0;

        // إعدادات اللاعب
        const player = {
            x: 50,
            y: 200,
            w: 30,
            h: 30,
            v: 0,
            g: 0.6,
            jump: -10
        };

        const obstacles = [];

        function drawPlayer() {
            ctx.fillStyle = "#0ff";
            ctx.shadowBlur = 15;
            ctx.shadowColor = "#0ff";
            ctx.fillRect(player.x, player.y, player.w, player.h);
            ctx.shadowBlur = 0;
        }

        function drawObstacles() {
            ctx.fillStyle = "#ff0055";
            ctx.shadowBlur = 10;
            ctx.shadowColor = "#ff0055";
            obstacles.forEach(obs => {
                ctx.fillRect(obs.x, obs.y, obs.w, obs.h);
            });
            ctx.shadowBlur = 0;
        }

        function update() {
            if (!gameActive) return;

            // تحريك اللاعب
            player.v += player.g;
            player.y += player.v;

            // حدود الشاشة
            if (player.y + player.h > canvas.height) {
                player.y = canvas.height - player.h;
                player.v = 0;
            }
            if (player.y < 0) player.y = 0;

            // توليد العوائق
            if (frames % 100 === 0) {
                obstacles.push({
                    x: canvas.width,
                    y: canvas.height - 50,
                    w: 30,
                    h: 50
                });
            }

            // تحريك العوائق وفحص التصادم
            for (let i = obstacles.length - 1; i >= 0; i--) {
                obstacles[i].x -= 5;

                // فحص التصادم
                if (
                    player.x < obstacles[i].x + obstacles[i].w &&
                    player.x + player.w > obstacles[i].x &&
                    player.y < obstacles[i].y + obstacles[i].h &&
                    player.y + player.h > obstacles[i].y
                ) {
                    gameActive = false;
                    document.getElementById('msg').innerHTML = "<span style='color:red'>تحطم الآلي! اضغط F5 للبدء من جديد</span>";
                }

                // حذف العوائق خارج الشاشة وزيادة السكور
                if (obstacles[i].x + obstacles[i].w < 0) {
                    obstacles.splice(i, 1);
                    score++;
                    document.getElementById('score').innerText = `الطاقة: ${score}%`;
                }
            }
            frames++;
        }

        function loop() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // رسم خلفية بسيطة (خطوط نيون)
            ctx.strokeStyle = "#222";
            for(let i=0; i<canvas.width; i+=50) {
                ctx.beginPath(); ctx.moveTo(i, 0); ctx.lineTo(i, canvas.height); ctx.stroke();
            }

            drawPlayer();
            drawObstacles();
            update();
            requestAnimationFrame(loop);
        }

        // التحكم
        window.addEventListener('keydown', (e) => {
            if (e.code === 'Space') player.v = player.jump;
        });
        canvas.addEventListener('touchstart', () => {
            player.v = player.jump;
        });

        loop();
    </script>
</body>
</html>
