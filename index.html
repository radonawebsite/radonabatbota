<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>THE ENTITY | النظام</title>
    <style>
        body { background: #000; color: #ff0000; font-family: monospace; text-align: center; padding-top: 20vh; }
        #timer { font-size: 5rem; text-shadow: 0 0 20px #ff0000; }
        button { background: none; border: 2px solid #ff0000; color: #ff0000; padding: 15px; cursor: pointer; margin-top: 30px; }
        button:hover { background: #ff0000; color: #000; }
    </style>
</head>
<body>

    <div id="timer">--:--:--</div>
    <button id="btn">تبرع بـ 10 ثواني</button>

    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBGbP9HXebg4Z5WabWF4CEq9zJ5QEHO7PU",
            databaseURL: "https://realtime-database-df34b-default-rtdb.firebaseio.com",
            projectId: "realtime-database-df34b"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const timerRef = db.ref('globalTimer');

        // تحديث الشاشة
        timerRef.on('value', (snapshot) => {
            let val = snapshot.val();
            if (val === null) {
                document.getElementById('timer').innerText = "OFFLINE";
            } else {
                let h = Math.floor(val / 3600);
                let m = Math.floor((val % 3600) / 60);
                let s = val % 60;
                document.getElementById('timer').innerText = 
                    `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
            }
        });

        // التبرع (زيادة الوقت للجميع)
        document.getElementById('btn').onclick = () => {
            timerRef.transaction(t => (t || 86400) + 10);
        };

        // إنقاص الوقت (العد التنازلي العالمي)
        setInterval(() => {
            timerRef.transaction(t => {
                if (t && t > 0) return t - 1;
                return 0;
            });
        }, 1000);
    </script>
</body>
</html>
